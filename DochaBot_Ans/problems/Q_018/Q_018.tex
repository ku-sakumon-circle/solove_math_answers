\begin{thm}{018}{\hosi 5}{並べ替え数列}
 数列$1,2,\cdots, n$ のある並び替えを $a_1.a_2,\cdots , a_n$ とする。\\
 \begin{enumerate}
  \item $\disp \sum_{k=1}^n(a_k-k)^2+\sum^n_{k=1}(a_k-n+k-1)^2$ を$n$で表せ。
  \item $\disp \sum_{k=1}^n(a_k-k)^2$ の最大値を求めよ。
  \item $\disp \sum_{k=1}^nka_k$ が最小となるとき、 $a_k=n+1-k$ であることを証明せよ。
 \end{enumerate}
\end{thm}

\syoumon{1}
括弧を展開して一つのシグマの中に入れると 
\begin{align*}
&\sum_{k=1}^n \{2a_k^2-2(n+1)a_k + k^2 + (n+1-k)^2 \}\\
=& 2\sum_{k=1}^na_k^2 -2(n+1)\sum_{k=1}^na_k + 2\sum_{k=1}^n k^2\\
=& 4\sum_{k=1}^nk^2 - 2(n+1)\sum_{k=1}^nk\\
=& \frac{n(n+1)(8n+4)}{6} - \frac{n(n+1)(6n+6)}{6}\\
=& \frac{n(n+1)(n-1)}{3}=\frac{n^3-n}{3}
\end{align*}

\syoumon{2}
(1) より
\[\disp\sum_{k=1}^n(a_k-k)^2 = \dfrac{n^3-n}{3}-\disp\sum_{k=1}^n (a_k-n+k-1)^2\]
であって, 右辺を最大化したい。 2乗の和なので$\disp\sum_{k=1}^n (a_k-n+k-1)^2\geq 0$が成り立ち, $a_k=n-k+1$ とすることで, $a_1,a_2,\cdots, a_n$は$1,2,\cdots ,n$の並び替えでありながら右辺が最大化されると分かる。よって, 最大値はそのような$a_k$のときに実現される $\dfrac{n^3-n}{3}$ である。

\syoumon{3}
(2) より
\[ \disp\sum_{k=1}^n (a_k^2+k^2 -2ka_k)=2\disp\sum_{k=1}^n k^2 -2\disp\sum_{k=1}^n ka_k\]
が最大化されるのが $a_k=n+1-k$ のときであるが, これは $\disp\sum_{k=1}^n ka_k$ を最小化させているときとも見れるので明らか。

